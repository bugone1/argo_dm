if 0
    fid=fopen('633.txt','r');
    fie=fopen('n633.txt','w');
    while ~feof(fid)
        lin=fgetl(fid);
        if isempty(lin)
            lin=' ';
        end
        if (lin(1)~=' ' && lin(1)~='1')
        else
            fprintf(fie,[lin '\n']);
        end
    end
    fclose all
end
mois=[08
08
08
09
09
09
10
10
10
11
11
11
12
12
12
01
01
01
02
02
02
03
03
03
04
04
04
05
05
05
06
06
06
07
07
07
07
08
08
08
09
09
09
10
10
10
11
11
11
12
12
12
01
01
01
02
02
02
03
03
03
04
04
04
05
05
05
06
06
06
07
07
08
08
10
11
11
01
01
02
02
02
03
03
06
06
10
11
03
05
07
10];

cyc=[1   -164.974  48.490 
2   -165.155  48.513 
3   -165.080  48.548 
4   -165.036  48.529 
5   -164.991  48.572 
6   -164.921  48.637 
7   -164.826  48.635 
8   -164.734  48.584 
9   -164.618  48.715 
10  -164.447  48.811 
11  -164.398  48.779 
12  -164.359  48.831 
13  -164.274  48.770 
14  -164.187  48.826 
15  -164.395  48.971 
16  -164.455  49.037 
17  -164.495  49.074 
18  -164.381  49.121 
19  -164.376  49.158 
20  -164.415  49.283 
21  -164.538  49.033 
22  -164.435  49.125 
23  -164.107  49.046 
24  -163.947  49.137 
25  -163.792  49.209 
26  -163.565  49.165 
27  -163.455  49.130 
28  -163.384  49.053 
29  -163.295  49.019 
30  -163.152  48.971 
31  -163.032  48.934 
32  -162.975  49.036 
33  -162.913  48.924 
34  -162.877  48.930 
35  -162.965  48.938 
36  -162.847  48.887 
37  -162.719  48.784 
38  -162.631  48.774 
39  -162.388  48.858 
40  -162.100  48.818 
41  -161.834  48.831 
42  -161.694  48.684 
43  -161.490  48.622 
44  -161.387  48.661 
45  -161.367  48.664 
46  -161.336  48.630 
47  -161.431  48.604 
48  -161.381  48.563 
49  -161.239  48.557 
50  -161.107  48.591 
51  -161.086  48.525 
52  -161.033  48.530 
53  -160.875  48.647 
54  -160.827  48.589 
55  -161.003  48.621 
56  -160.957  48.736 
57  -160.940  48.754 
58  -160.900  48.846 
59  -160.941  48.838 
60  -161.015  48.766 
61  -161.096  48.703 
62  -161.183  48.735 
63  -160.975  48.851 
64  -160.769  49.003 
65  -160.695  49.075 
66  -160.597  49.126 
67  -160.634  49.057 
68  -160.878  49.109 
69  -160.963  49.121 
70  -161.092  49.121 
71  -161.118  49.204 
73  -161.242  49.291 
74  -161.262  49.380 
76  -161.332  49.398 
81  -161.358  49.585 
84  -160.876  49.698 
85  -160.680  49.703 
89  -160.025  49.623 
91  -159.780  49.322 
92  -159.778  49.208 
93  -159.635  49.058 
94  -159.654  49.030 
95  -159.523  49.040 
96  -159.489  49.120 
106 -159.424  48.652
107 -159.459  48.746
119 -159.474  48.916
122 -159.396  49.005
133 -158.887  49.076
138 -158.352  49.174
146 -158.264  49.317
155 -157.577  49.765];


clear ok
nc=netcdf.open('4900633_tech.nc','nowrite')
cyc2=unique(netcdf.getVar(nc,netcdf.inqVarID(nc,'CYCLE_NUMBER')));
i=netcdf.inqVarID(nc,'TECHNICAL_PARAMETER_NAME');
allv=netcdf.getVar(nc,i)';
ok{1}=strmatch('POSITION_PistonPark_COUNT',allv);
ok{2}=strmatch('POSITION_PistonProfile_COUNT',allv);
ok{3}=strmatch('POSITION_PistonSurface_COUNT',allv);
j=netcdf.inqVarID(nc,'TECHNICAL_PARAMETER_VALUE');
val=netcdf.getVar(nc,j)';
clear e
for i=1:length(ok)
    for j=1:length(ok{i})
        e(j,i)=str2num(val(ok{i}(j),:));
    end
end

clear ok
q=load('633dep.txt');
ok=[0;find(diff(q(:,1))<0);size(q,1)];
jj=0;
for j=1:length(ok)-1
    jj=jj+1;
    okk=ok(j)+1:ok(j+1);
    p{jj}=q(okk,:);
    q(okk,4)=jj;
end
q(q==99.999)=nan;

for i=1:length(p)

[adje(i,:),r(i,:),s(i,:)]=rmsfit(cyc(i,2),cyc(i,3),mois(i),p{i}(:,2),p{i}(:,1),p{i}(:,3),182);
end
stop
[ux,uy,a]=make_c(q(:,4),q(:,1),unique(q(:,4)),unique(round(q(:,1)*10)/10),[100 100],q(:,3));
surface(1:92,uy,a','edgecolor','none')
contourf(cyc,uy,a')
set(gca,'ydir','reverse')
set(gca,'ylim',[-10 2000])